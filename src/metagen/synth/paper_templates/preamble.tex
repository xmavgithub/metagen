% MetaGen Academic Paper Preamble
% Custom style combining NeurIPS clarity with ICLR typography
% Generated by MetaGen - A spec-to-model synthesizer

% ============================================================================
% DOCUMENT CLASS AND GEOMETRY
% ============================================================================
\documentclass[11pt,a4paper]{article}

\usepackage[margin=1in]{geometry}
\usepackage[utf8]{inputenc}
\usepackage[T1]{fontenc}

% ============================================================================
% MATHEMATICS
% ============================================================================
\usepackage{amsmath}
\usepackage{amsthm}
\usepackage{amssymb}
\usepackage{mathtools}
\usepackage{bm}  % Bold math symbols

% Theorem environments
\newtheorem{theorem}{Theorem}
\newtheorem{lemma}[theorem]{Lemma}
\newtheorem{proposition}[theorem]{Proposition}
\newtheorem{corollary}[theorem]{Corollary}
\newtheorem{definition}{Definition}
\newtheorem{remark}{Remark}

% ============================================================================
% ALGORITHMS
% ============================================================================
\usepackage{algorithm}
\usepackage{algorithmic}

% Algorithm styling
\renewcommand{\algorithmicrequire}{\textbf{Input:}}
\renewcommand{\algorithmicensure}{\textbf{Output:}}

% ============================================================================
% GRAPHICS AND FIGURES
% ============================================================================
\usepackage{graphicx}
\usepackage{subcaption}
\usepackage{float}
\usepackage{wrapfig}

% TikZ for diagrams
\usepackage{tikz}
\usetikzlibrary{shapes,arrows,positioning,fit,backgrounds,calc}

% ============================================================================
% TABLES
% ============================================================================
\usepackage{booktabs}
\usepackage{multirow}
\usepackage{array}
\usepackage{tabularx}

% Professional table column types
\newcolumntype{L}[1]{>{\raggedright\arraybackslash}p{#1}}
\newcolumntype{C}[1]{>{\centering\arraybackslash}p{#1}}
\newcolumntype{R}[1]{>{\raggedleft\arraybackslash}p{#1}}

% ============================================================================
% COLORS (Tableau 10 Palette - Colorblind Friendly)
% ============================================================================
\usepackage{xcolor}

% Primary colors
\definecolor{metagen-blue}{RGB}{31,119,180}
\definecolor{metagen-orange}{RGB}{255,127,14}
\definecolor{metagen-green}{RGB}{44,160,44}
\definecolor{metagen-red}{RGB}{214,39,40}
\definecolor{metagen-purple}{RGB}{148,103,189}

% Secondary colors
\definecolor{metagen-brown}{RGB}{140,86,75}
\definecolor{metagen-pink}{RGB}{227,119,194}
\definecolor{metagen-gray}{RGB}{127,127,127}
\definecolor{metagen-olive}{RGB}{188,189,34}
\definecolor{metagen-cyan}{RGB}{23,190,207}

% Semantic colors
\definecolor{metagen-link}{RGB}{0,102,204}
\definecolor{metagen-cite}{RGB}{0,128,0}

% ============================================================================
% BIBLIOGRAPHY
% ============================================================================
\usepackage[numbers,sort&compress]{natbib}
\bibliographystyle{plainnat}

% ============================================================================
% HYPERLINKS AND PDF METADATA
% ============================================================================
\usepackage[breaklinks=true,hidelinks]{hyperref}
\usepackage{url}
\urlstyle{same}

% PDF bookmarks
\usepackage{bookmark}

% ============================================================================
% CODE LISTINGS
% ============================================================================
\usepackage{listings}

\lstset{
    basicstyle=\ttfamily\small,
    breaklines=true,
    frame=single,
    numbers=left,
    numberstyle=\tiny\color{metagen-gray},
    keywordstyle=\color{metagen-blue}\bfseries,
    commentstyle=\color{metagen-green}\itshape,
    stringstyle=\color{metagen-orange},
    showstringspaces=false,
    tabsize=2,
    captionpos=b
}

% YAML language definition
\lstdefinelanguage{yaml}{
    keywords={true,false,null,y,n},
    sensitive=false,
    comment=[l]{\#},
    morecomment=[s]{/*}{*/},
    morestring=[b]',
    morestring=[b]"
}

% ============================================================================
% TYPOGRAPHY AND SPACING
% ============================================================================
\usepackage{microtype}  % Microtypographic improvements
\usepackage{setspace}
\onehalfspacing

% Paragraph formatting
\setlength{\parindent}{1em}
\setlength{\parskip}{0.5em}

% ============================================================================
% HEADERS AND FOOTERS
% ============================================================================
\usepackage{fancyhdr}
\pagestyle{fancy}
\fancyhf{}
\fancyhead[L]{\small\leftmark}
\fancyhead[R]{\small\thepage}
\renewcommand{\headrulewidth}{0.4pt}

% ============================================================================
% ABSTRACT ENVIRONMENT
% ============================================================================
\renewenvironment{abstract}{%
    \small
    \begin{center}
        \bfseries Abstract
    \end{center}
    \begin{quotation}
}{%
    \end{quotation}
}

% ============================================================================
% CUSTOM COMMANDS
% ============================================================================

% Model and architecture names
\newcommand{\modelname}[1]{\textsc{#1}}
\newcommand{\metagen}{\modelname{MetaGen}}

% Math operators
\DeclareMathOperator*{\argmax}{arg\,max}
\DeclareMathOperator*{\argmin}{arg\,min}
\DeclareMathOperator{\softmax}{softmax}
\DeclareMathOperator{\sigmoid}{\sigma}
\DeclareMathOperator{\relu}{ReLU}
\DeclareMathOperator{\gelu}{GELU}

% Vectors and matrices
\newcommand{\vect}[1]{\bm{#1}}
\newcommand{\matr}[1]{\bm{#1}}

% Probability and expectation
\newcommand{\E}{\mathbb{E}}
\newcommand{\Prob}{\mathbb{P}}
\newcommand{\R}{\mathbb{R}}
\newcommand{\N}{\mathbb{N}}

% Loss functions
\newcommand{\Loss}{\mathcal{L}}
\newcommand{\Lce}{\Loss_{\text{CE}}}
\newcommand{\Lmse}{\Loss_{\text{MSE}}}
\newcommand{\Ldiff}{\Loss_{\text{diff}}}

% Architecture notation
\newcommand{\hidden}{d_{\text{model}}}
\newcommand{\heads}{n_{\text{heads}}}
\newcommand{\layers}{n_{\text{layers}}}
\newcommand{\seqlen}{L_{\text{seq}}}
\newcommand{\vocab}{V}

% Parameters
\newcommand{\params}{\theta}
\newcommand{\nparams}{|\params|}

% Attention
\newcommand{\attn}{\text{Attention}}
\newcommand{\mha}{\text{MHA}}

% Footnote without marker (for paper disclaimers)
\newcommand{\blfootnote}[1]{%
    \begingroup
    \renewcommand\thefootnote{}\footnote{#1}%
    \addtocounter{footnote}{-1}%
    \endgroup
}

% Highlight important text
\newcommand{\highlight}[1]{\textcolor{metagen-blue}{\textbf{#1}}}

% Todo notes (for drafts)
\newcommand{\todo}[1]{\textcolor{metagen-red}{\textbf{[TODO: #1]}}}

% ============================================================================
% TIKZ STYLES FOR PIPELINE DIAGRAMS
% ============================================================================

\tikzstyle{metagen-block} = [
    rectangle,
    rounded corners,
    draw=metagen-blue,
    fill=metagen-blue!10,
    thick,
    minimum height=1cm,
    minimum width=2cm,
    text centered,
    font=\small
]

\tikzstyle{metagen-io} = [
    trapezium,
    trapezium left angle=70,
    trapezium right angle=110,
    draw=metagen-green,
    fill=metagen-green!10,
    thick,
    minimum height=0.8cm,
    text centered,
    font=\small
]

\tikzstyle{metagen-arrow} = [
    ->,
    thick,
    >=stealth,
    color=metagen-gray
]

\tikzstyle{metagen-label} = [
    font=\scriptsize,
    color=metagen-gray
]

% ============================================================================
% END PREAMBLE
% ============================================================================
