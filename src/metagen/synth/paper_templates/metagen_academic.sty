% MetaGen Academic Style
% Additional formatting for publication-quality papers
% Generated by MetaGen - A spec-to-model synthesizer

\NeedsTeXFormat{LaTeX2e}
\ProvidesPackage{metagen_academic}[2024/01/01 MetaGen Academic Style]

% ============================================================================
% SECTION FORMATTING
% ============================================================================

\usepackage{titlesec}

% Section styling
\titleformat{\section}
    {\normalfont\Large\bfseries}
    {\thesection}
    {1em}
    {}

\titleformat{\subsection}
    {\normalfont\large\bfseries}
    {\thesubsection}
    {1em}
    {}

\titleformat{\subsubsection}
    {\normalfont\normalsize\bfseries}
    {\thesubsubsection}
    {1em}
    {}

% Section spacing
\titlespacing*{\section}{0pt}{3.5ex plus 1ex minus .2ex}{2.3ex plus .2ex}
\titlespacing*{\subsection}{0pt}{3.25ex plus 1ex minus .2ex}{1.5ex plus .2ex}
\titlespacing*{\subsubsection}{0pt}{3.25ex plus 1ex minus .2ex}{1.5ex plus .2ex}

% ============================================================================
% FIGURE AND TABLE CAPTIONS
% ============================================================================

\usepackage{caption}

\captionsetup{
    font=small,
    labelfont=bf,
    format=hang,
    margin=1cm
}

\captionsetup[figure]{name=Figure}
\captionsetup[table]{name=Table}
\captionsetup[algorithm]{name=Algorithm}

% ============================================================================
% THEOREM-LIKE ENVIRONMENTS
% ============================================================================

% Contribution environment
\newenvironment{contribution}{%
    \begin{quote}
    \itshape
}{%
    \end{quote}
}

% Research question environment
\newenvironment{researchquestion}{%
    \begin{quote}
    \textbf{Research Question:}
    \itshape
}{%
    \end{quote}
}

% Key finding environment
\newenvironment{keyfinding}{%
    \begin{quote}
    \textcolor{metagen-blue}{\textbf{Key Finding:}}
    \itshape
}{%
    \end{quote}
}

% ============================================================================
% LISTS
% ============================================================================

\usepackage{enumitem}

% Tighter lists
\setlist{nosep}
\setlist[itemize]{leftmargin=*}
\setlist[enumerate]{leftmargin=*}

% Custom contribution list
\newlist{contributions}{enumerate}{1}
\setlist[contributions]{
    label=\textbf{C\arabic*.},
    leftmargin=2.5em,
    itemsep=0.5em
}

% ============================================================================
% QUOTES AND EPIGRAPHS
% ============================================================================

\usepackage{epigraph}

\setlength{\epigraphwidth}{0.8\textwidth}
\setlength{\epigraphrule}{0pt}

\renewcommand{\epigraphflush}{center}
\renewcommand{\textflush}{center}

% ============================================================================
% MARGIN NOTES
% ============================================================================

\usepackage{marginnote}

\newcommand{\margintodo}[1]{%
    \marginnote{\textcolor{metagen-red}{\scriptsize TODO: #1}}%
}

% ============================================================================
% APPENDIX FORMATTING
% ============================================================================

\usepackage{appendix}

% Reset equation/figure/table numbering in appendix
\newcommand{\appendixsetup}{%
    \setcounter{equation}{0}
    \setcounter{figure}{0}
    \setcounter{table}{0}
    \renewcommand{\theequation}{A.\arabic{equation}}
    \renewcommand{\thefigure}{A.\arabic{figure}}
    \renewcommand{\thetable}{A.\arabic{table}}
}

% ============================================================================
% SPECIAL BOXES
% ============================================================================

\usepackage{tcolorbox}
\tcbuselibrary{skins,breakable}

% Definition box
\newtcolorbox{definitionbox}[1][]{
    colback=metagen-blue!5,
    colframe=metagen-blue,
    fonttitle=\bfseries,
    title=#1,
    breakable
}

% Warning box
\newtcolorbox{warningbox}[1][]{
    colback=metagen-orange!5,
    colframe=metagen-orange,
    fonttitle=\bfseries,
    title=#1,
    breakable
}

% Insight box
\newtcolorbox{insightbox}[1][]{
    colback=metagen-green!5,
    colframe=metagen-green,
    fonttitle=\bfseries,
    title=#1,
    breakable
}

% ============================================================================
% CROSS-REFERENCES
% ============================================================================

\usepackage[capitalise,noabbrev]{cleveref}

\crefname{figure}{Figure}{Figures}
\crefname{table}{Table}{Tables}
\crefname{equation}{Equation}{Equations}
\crefname{section}{Section}{Sections}
\crefname{algorithm}{Algorithm}{Algorithms}
\crefname{theorem}{Theorem}{Theorems}
\crefname{lemma}{Lemma}{Lemmas}
\crefname{definition}{Definition}{Definitions}

% ============================================================================
% INLINE CODE
% ============================================================================

\newcommand{\code}[1]{\texttt{#1}}
\newcommand{\specfield}[1]{\texttt{#1}}
\newcommand{\filename}[1]{\texttt{#1}}

% ============================================================================
% METRICS AND NUMBERS
% ============================================================================

% Format large numbers with commas
\usepackage{siunitx}
\sisetup{
    group-separator={,},
    group-minimum-digits=4
}

% Percentage formatting
\newcommand{\pct}[1]{\SI{#1}{\percent}}

% Parameter count
\newcommand{\params}[1]{\SI{#1}{} parameters}
\newcommand{\billion}[1]{\SI{#1}{\giga} parameters}
\newcommand{\million}[1]{\SI{#1}{\mega} parameters}

% ============================================================================
% AUTHOR AFFILIATIONS (for title page)
% ============================================================================

\newcommand{\affilimark}[1]{\textsuperscript{#1}}
\newcommand{\affiliation}[2]{\textsuperscript{#1}#2}

% ============================================================================
% DRAFT MODE
% ============================================================================

\newif\ifdraft
\draftfalse  % Set to \drafttrue for draft mode

\ifdraft
    \usepackage{lineno}
    \linenumbers
    \usepackage{showframe}
\fi

% ============================================================================
% END STYLE
% ============================================================================

\endinput
